{
    "collab_server" : "",
    "contents" : "#Plotting trajectories\nnormalized_positions.plot.X = calibration_data %>%\n  dplyr::select(Subject,Polarity, Expected_response, Normalized.positions.X, lda_measure, Item.number) %>%\n  separate(Normalized.positions.X, into= as.character(c(1:101)), sep = \",\") %>%\n  gather(Time.Step, X.Position, 4:104) \nnormalized_positions.plot.Y = calibration_data %>%\n  dplyr::select(Subject,Polarity, Expected_response, Normalized.positions.Y, lda_measure,  Item.number) %>%\n  separate(Normalized.positions.Y, into= as.character(c(1:101)), sep = \",\") %>%\n  gather(Time.Step, Y.Position, 4:104) \nnormalized_positions.plot <- merge(normalized_positions.plot.X,normalized_positions.plot.Y)\n#rm(normalized_positions.plot.X,normalized_positions.plot.Y)\n\nnormalized_positions.plot$X.Position<- as.numeric(normalized_positions.plot$X.Position)\nnormalized_positions.plot$Y.Position <- as.numeric(normalized_positions.plot$Y.Position)\nnormalized_positions.plot$Time.Step <- as.numeric(normalized_positions.plot$Time.Step)\nnormalized_positions.plot$Subject <- factor(normalized_positions.plot$Subject)\nnormalized_positions.plot$Polarity <- factor(normalized_positions.plot$Polarity )\nnormalized_positions.plot$lda_measure_cut <- cut(normalized_positions.plot$lda_measure, 5)\nnormalized_positions.plot$grp <- paste(normalized_positions.plot$Subject,normalized_positions.plot$Item.number)\n\nnormalized_positions.plot.false = normalized_positions.plot %>%\n  filter(Expected_response=='false')%>%\n  dplyr::mutate_at('X.Position', funs('-'))\nnormalized_positions.plot.true = normalized_positions.plot %>%\n  filter(Expected_response=='true')\nnormalized_positions.plot <- rbind(normalized_positions.plot.false, normalized_positions.plot.true)\nsummary(normalized_positions.plot)\n\n#Plotting real subjects\nggplot(normalized_positions.plot, aes(x=X.Position, y=Y.Position, color=Polarity, group=grp)) + geom_point(alpha=.4, size=1) + theme(legend.position = \"none\") + \n  facet_grid(lda_measure_cut~Expected_response)     \nggsave('LDA-trajectories1_all.png', plot = last_plot(), scale = 1, dpi = 300)\n\nggplot(normalized_positions.plot, aes(x=Time.Step, y=X.Position, color=Polarity, group=grp)) + geom_point(alpha=.4, size=1) + geom_line()+ theme(legend.position = \"none\") + \n  facet_grid(lda_measure_cut~Expected_response) \nggsave('LDA-trajectories2_all.png', plot = last_plot(), scale = 1, dpi = 300)\n\n\n#Plotting real means\nnormalized_positions.means <- ddply(normalized_positions.plot, c(\"Polarity\", \"Time.Step\", \"Expected_response\"),\n                                    function(normalized_positions.means)c(X.Position.mean=mean(normalized_positions.means$X.Position, na.rm=T), X.Position.se=se(normalized_positions.means$X.Position, na.rm=T)))\nggplot(normalized_positions.means, aes(x=Time.Step, y=X.Position.mean, color=Polarity, group=Polarity)) + geom_point(alpha=.6) + geom_line() + theme(legend.position = \"none\") + facet_grid(.~Expected_response) + \ngeom_errorbar(aes(ymin=X.Position.mean-X.Position.se, ymax=X.Position.mean+X.Position.se), width=.1) \n\nnormalized_positions.means.traj <- ddply(normalized_positions.plot, c(\"Polarity\", \"Time.Step\", \"Expected_response\"),\n                                    function(normalized_positions.means)c(X.Position.mean=mean(normalized_positions.means$X.Position, na.rm=T), \n                                                                          X.Position.se=se(normalized_positions.means$X.Position, na.rm=T),\n                                                                          Y.Position.mean=mean(normalized_positions.means$Y.Position, na.rm=T), \n                                                                          Y.Position.se=se(normalized_positions.means$Y.Position, na.rm=T)))\n\nggplot(normalized_positions.means, aes(x=Time.Step, y=X.Position.mean, color=Polarity, group=Polarity)) + geom_point(alpha=.6) + geom_line() + theme(legend.position = \"none\") + facet_grid(.~Expected_response) + \n  geom_errorbar(aes(ymin=X.Position.mean-X.Position.se, ymax=X.Position.mean+X.Position.se), width=.1) \n\nggplot(normalized_positions.means.traj, aes(x=X.Position.mean, y=Y.Position.mean, color=Polarity, group=Polarity)) + geom_point(alpha=.6) + theme(legend.position = \"none\") + facet_grid(.~Expected_response) \n\n",
    "created" : 1491563733614.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2861592567",
    "id" : "E6A4C307",
    "lastKnownWriteTime" : 1491563753,
    "last_content_update" : 1491563753005,
    "path" : "~/WebstormProjects/negationMT/R_scripts/trajectories.R",
    "project_path" : "R_scripts/trajectories.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}